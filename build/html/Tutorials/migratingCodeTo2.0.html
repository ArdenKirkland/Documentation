

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Migrating your code to Omeka 2.0 &mdash; Omeka Documentation v2.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <link rel="top" title="Omeka Documentation v2.0 documentation" href="../index.html" />
    <link rel="up" title="Tutorials for Plugin and Theme Developers" href="index.html" />
    <link rel="next" title="Principles of Omeka 2.0" href="principlesOfOmeka2.html" />
    <link rel="prev" title="Best Practices for Plugin Development" href="bestPracticesPlugins.html" />
    <link rel="stylesheet" href="../_static/overrides.css" type="text/css" />
 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="principlesOfOmeka2.html" title="Principles of Omeka 2.0"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bestPracticesPlugins.html" title="Best Practices for Plugin Development"
             accesskey="P">previous</a> |</li>
    
        <li><a href="../index.html">Omeka Documentation v2.0 documentation</a> &raquo;</li>
    <p style="background-color: white; color:red;">
    This documentation is currently unstable as changes continue to be made to Omeka 2.0.    
     The final release of Omeka 2.0 may have changes.</p>    

          <li><a href="index.html" accesskey="U">Tutorials for Plugin and Theme Developers</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="migrating-your-code-to-omeka-2-0">
<span id="migrating"></span><h1>Migrating your code to Omeka 2.0<a class="headerlink" href="#migrating-your-code-to-omeka-2-0" title="Permalink to this headline">¶</a></h1>
<p>There are significant changes moving from Omeka 1.5 to Omeka 2.0. <a class="reference internal" href="principlesOfOmeka2.html#principlesofomeka2"><em>Principles of Omeka 2.0</em></a> offers an overall guide to the principles, both for theme developers and plugin developers.</p>
<p>Here, you will find a skeleton of typical tasks that will be required to migrate your code. Consult the reference section for code details, and the notes about changes in our wiki will also be helpful.</p>
<div class="section" id="upgrading-plugins">
<h2>Upgrading Plugins<a class="headerlink" href="#upgrading-plugins" title="Permalink to this headline">¶</a></h2>
<p>As you look through the lists of typical tasks below, you might also want to consult <a class="reference internal" href="bestPracticesPlugins.html#bestpracticesplugins"><em>Best Practices for Plugin Development</em></a></p>
<p>Typical tasks you will need to do to upgrade your plugins for Omeka 2.0 are:</p>
<ul>
<li><p class="first">Change the classes your controllers and models extend from</p>
<blockquote>
<div><ul class="simple">
<li>Omeka_Controller_Action becomes <a class="reference internal" href="../Reference/libraries/Omeka/Controller/AbstractActionController.html#Omeka_Controller_AbstractActionController" title="Omeka_Controller_AbstractActionController"><tt class="xref php php-class docutils literal"><span class="pre">Omeka_Controller_AbstractActionController</span></tt></a></li>
<li>Omeka_Record becomes <a class="reference internal" href="../Reference/libraries/Omeka/Record/AbstractRecord.html#Omeka_Record_AbstractRecord" title="Omeka_Record_AbstractRecord"><tt class="xref php php-class docutils literal"><span class="pre">Omeka_Record_AbstractRecord</span></tt></a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Update any helper functions you use in hooks for filters</p>
</li>
<li><p class="first">Change your hook callbacks to have an array passed in. Typically, the expected variable name passed in in version 1.5 (e.g. <tt class="docutils literal"><span class="pre">$user</span></tt>) becomes the key for the corresponding data in the array, e.g. <tt class="docutils literal"><span class="pre">$user</span> <span class="pre">=</span> <span class="pre">$args['user'];</span></tt> See <a class="reference external" href="http://omeka.org/codex/Updating_Plugins_For_2.0#Hooks_and_Filters">Updating Plugins for 2.0: Hooks and Filters</a></p>
</li>
<li><p class="first">Update any filters you use. The third argument must now be an array to fit with the standard above.</p>
</li>
<li><p class="first">Change the helper functions used in the views ** All functions of the form <tt class="docutils literal"><span class="pre">loop_{record</span> <span class="pre">type}</span></tt>, like <tt class="docutils literal"><span class="pre">loop_items()</span></tt>, become <tt class="docutils literal"><span class="pre">loop(&quot;{record</span> <span class="pre">type}&quot;)</span></tt></p>
</li>
<li><p class="first">Change usage of function that previously echoed content. For example, <tt class="docutils literal"><span class="pre">&lt;?php</span> <span class="pre">head();</span> <span class="pre">?&gt;</span></tt> should now be <tt class="docutils literal"><span class="pre">&lt;?php</span> <span class="pre">echo</span> <span class="pre">head();</span> <span class="pre">?&gt;</span></tt>.</p>
</li>
</ul>
<div class="section" id="controllers">
<h3>Controllers<a class="headerlink" href="#controllers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Update wrapper methods <tt class="docutils literal"><span class="pre">findById()</span></tt>, <tt class="docutils literal"><span class="pre">getTable('TableName')</span></tt>, <tt class="docutils literal"><span class="pre">getDb()</span></tt></li>
</ul>
</div>
<div class="section" id="views">
<h3>Views<a class="headerlink" href="#views" title="Permalink to this headline">¶</a></h3>
<div class="section" id="admin-views">
<h4>Admin Views<a class="headerlink" href="#admin-views" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Many new CSS classes are available and should be used to ensure a consistent look and feel across Omeka plugins. It will be helpful to become familiar with them. For example, this is the new code structure to use if you need to create inputs yourself:</p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;administrator_email-label&quot;</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;two columns alpha&quot;</span><span class="o">&gt;&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&quot;administrator_email&quot;</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;required&quot;</span><span class="o">&gt;</span><span class="nx">Administrator</span> <span class="nx">Email</span><span class="o">&lt;/</span><span class="nx">label</span><span class="o">&gt;&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;inputs five columns omega&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;administrator_email&quot;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;administrator_email&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;knguye27@gmu.edu &lt;mailto:value=%22knguye27@gmu.edu&gt;&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Admin theme now displays an <tt class="docutils literal"><span class="pre">&lt;h1&gt;</span></tt> with the title you set for the page. You can remove those from your admin views</p>
</li>
<li><p class="first">Use new save panel features. For ease of use in the most common cases, the <a class="reference internal" href="../Reference/libraries/Omeka/Form/Admin.html#Omeka_Form_Admin" title="Omeka_Form_Admin"><tt class="xref php php-class docutils literal"><span class="pre">Omeka_Form_Admin</span></tt></a> is available.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="upgrading-themes">
<h2>Upgrading Themes<a class="headerlink" href="#upgrading-themes" title="Permalink to this headline">¶</a></h2>
<p>The number of global functions has been cut nearly in half in Omeka 2.0. This will require many changes to your themes, but will also make the patterns of usage much easier to follow and much more consistent.</p>
<p>Here are a few of the basic tasks for upgrading.</p>
<ul>
<li><p class="first">Change the various metadata-retrieval functions for different record types (e.g., <tt class="docutils literal"><span class="pre">item()</span></tt>, <tt class="docutils literal"><span class="pre">collection()</span></tt>, etc) to the generalized <tt class="xref php php-func docutils literal"><span class="pre">metadata</span></tt> function.</p>
</li>
<li><p class="first">Change the loop structure for the various record types (e.g., <tt class="docutils literal"><span class="pre">loop_items()</span></tt>, <tt class="docutils literal"><span class="pre">loop_collections</span></tt>, etc) to the generalized <tt class="xref php php-func docutils literal"><span class="pre">loop</span></tt> function. Note that the structure changes from</p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span class="k">while</span><span class="p">(</span><span class="nx">loop_items</span><span class="p">())</span> <span class="o">:</span>
</pre></div>
</div>
<p>to</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">foreach</span><span class="p">(</span><span class="nx">loop</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span><span class="o">:</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p><tt class="xref php php-func docutils literal"><span class="pre">metadata</span></tt></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo-horizontal-200px.gif" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Migrating your code to Omeka 2.0</a><ul>
<li><a class="reference internal" href="#upgrading-plugins">Upgrading Plugins</a><ul>
<li><a class="reference internal" href="#controllers">Controllers</a></li>
<li><a class="reference internal" href="#views">Views</a><ul>
<li><a class="reference internal" href="#admin-views">Admin Views</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#upgrading-themes">Upgrading Themes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="bestPracticesPlugins.html"
                        title="previous chapter">Best Practices for Plugin Development</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="principlesOfOmeka2.html"
                        title="next chapter">Principles of Omeka 2.0</a></p>
  <h3>This Page</h3>
  <p>See something wrong or confusing on this page?
    Please open an issue on <a href="https://github.com/omeka/Documentation/issues.rst" rel="nofollow">Github</a>
    </p>
  <ul class="this-page-menu">
    
    <li><a href="https://github.com/omeka/Documentation/master/sourceTutorials/migratingCodeTo2.0.rst"
           rel="nofollow">View Source</a>
    </li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="principlesOfOmeka2.html" title="Principles of Omeka 2.0"
             >next</a> |</li>
        <li class="right" >
          <a href="bestPracticesPlugins.html" title="Best Practices for Plugin Development"
             >previous</a> |</li>
    
        <li><a href="../index.html">Omeka Documentation v2.0 documentation</a> &raquo;</li>
    <p style="background-color: white; color:red;">
    This documentation is currently unstable as changes continue to be made to Omeka 2.0.    
     The final release of Omeka 2.0 may have changes.</p>    

          <li><a href="index.html" >Tutorials for Plugin and Theme Developers</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Roy Rosenzweig Center for History and New Media.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>